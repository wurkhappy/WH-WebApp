define(["backbone","handlebars","text!templates/agreement/comment_tpl.html"],function(e,t,n){var r=e.View.extend({template:t.compile(n),className:"hide comment_container",initialize:function(e){this.agreement=e.agreement,this.avatar=e.user.get("avatarURL"),this.milestone=this.agreement.get("payments").get(this.model.get("milestoneID")),this.status=this.agreement.get("statusHistory").get(this.model.get("statusID")),this.commentCreatedDate=this.model.get("dateCreated"),this.firstName=e.user.get("firstName"),this.lastName=e.user.get("lastName"),this.userID=e.user.get("id"),this.messageUserID=this.model.get("userID"),this.email=e.user.get("email"),this.otherUserFirstName=e.otherUser.get("firstName"),this.otherUserLastName=e.otherUser.get("lastName"),this.otherUserEmail=e.otherUser.get("email"),this.otherAvatar=e.otherUser.get("avatarURL")},render:function(){var e,t,n,r,i,s,o,u,a;if(this.status){var f=this.status.get("paymentID")?"Payment":"Agreement";e=f+" "+this.status.get("action")+" on "+this.status.get("date").format("MMM D, YYYY")}if($(".discussion_placeholder")){var l=$(".discussion_placeholder");l.remove()}this.commentCreatedDate&&(t=this.commentCreatedDate.format("h:mm a"));var o=this.userID===this.messageUserID;this.firstName||this.lastName?s=this.firstName+" "+this.lastName:s=this.otherUserEmail,this.avatar?n=this.avatar:n="/img/default_photo.jpg",this.otherAvatar?a=this.otherAvatar:a="/img/default_photo.jpg",this.otherUserFirstName||this.otherUserLastName?u=this.otherUserFirstName+" "+this.otherUserLastName:u=this.email;var c=this.milestone?this.milestone.get("title"):"";return this.$el.html(this.template({model:this.model.toJSON(),milestoneTitle:c,statusTitle:e,dateCreated:t,thisAvatar:n,name:s,isThisUserMessage:o,otherName:u,otherAvatar:a})),this.fadeIn(this.$el),this},fadeIn:function(e){_.defer(function(){e.fadeIn()})}});return r});