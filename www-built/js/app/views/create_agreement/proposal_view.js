define(["backbone","handlebars","underscore","moment","parsley","text!templates/create_agreement/proposal_tpl.html"],function(e,t,n,r,i,s){var o=e.View.extend({className:"clear white_background",attributes:{id:"content"},template:t.compile(s),initialize:function(e){this.userID=e.userID,this.render()},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},events:{"blur input":"updateField",'blur input[type="radio"]':"updateRole",'blur input[type="checkbox"]':"updateClauses","blur textarea":"updateField","click .submit-buttons":"saveAndContinue","mouseenter .create_agreement_navigation_link":"mouseEnterNavigation","mouseleave .create_agreement_navigation_link":"mouseLeaveNavigation","click .create_agreement_navigation_link":"showPage"},updateField:function(e){this.model.set(e.target.name,e.target.value)},updateRole:function(e){this.model.unset("clientID"),this.model.unset("freelancerID"),this.model.set(e.target.value,this.userID),e.target.value=="clientID"},updateClauses:function(e){var t=$(e.target);this.model.get("clauses").add({id:t.data("clauseid"),text:t.data("text"),userID:this.userID})},saveAndContinue:function(e){e.preventDefault(),e.stopPropagation(),this.model.set("draft",!0),this.model.save({},{success:n.bind(function(e,t){window.location.hash="estimate"},this)})},showPage:function(e){$(e.currentTarget).find("h2").removeClass("create_agreement_navigation_link_hover"),e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget).attr("href");this.model.save({},{success:n.bind(function(e,n){window.location.hash=t},this)})},mouseEnterNavigation:function(e){$(e.currentTarget).find("h2").addClass("create_agreement_navigation_link_hover")},mouseLeaveNavigation:function(e){$(e.currentTarget).find("h2").removeClass("create_agreement_navigation_link_hover")}});return o});